---
title: 微信小程序自定义组件实践
date: 2018-04-01 18:01:06
tags:
    - 微信小程序
    - 自定义组件
    - 实践
categories: 微信小程序
---
>从小程序基础库版本 1.6.3 开始，小程序支持简洁的组件化编程。所有自定义组件相关特性都需要基础库版本 1.6.3 或更高。
>开发者可以将页面内的功能模块抽象成自定义组件，以便在不同的页面中重复使用；也可以将复杂的页面拆分成多个低耦合的模块，有助于代码维护。自定义组件在使用时与基础组件非常相似。

作为一个小程序初学者，一开始看到[自定义组件][0]时，虽然文档已经写的很详细了，整体上都能看的懂，但看完之后感觉缺少实践理解不是很透彻，好在后来项目开发中需要自定义 PickerView，实践过后感觉熟练了不少，此时把开发过程中的一些实践配合官方文档总结下来。

<!--more-->

## 创建自定义组件

创建一个自定义组件十分简单，只需要在项目中点击`右键=>新建=>Component`，输入组件名，就会生成相应的 `json`，`wxml`，`wxss`，`js` 文件（为了方便管理，建议把自定义组件相关代码文件放在同一文件夹下面）。我们可以看到在 `json` 文件中已经将 `component` 属性设置为 `true`，代表这组文件为自定义组件。

``` index.json
{
  "component": true,
  "usingComponents": {}
}
```
同时，还要在 `wxml` 文件中编写组件模版，在 `wxss` 文件中加入组件样式，在 `js` 文件中写对应的组件逻辑。

接下来，就要考虑下组件需要实现哪些功能。这里要实现的是一个 `PickerView`。设计如下：
{% gp 4-3 %}
![](http://p4wb4s2l1.bkt.clouddn.com/image/blog/2/1.png-blog)
![](http://p4wb4s2l1.bkt.clouddn.com/image/blog/2/2.png-blog)
![](http://p4wb4s2l1.bkt.clouddn.com/image/blog/2/3.png-blog)
![](http://p4wb4s2l1.bkt.clouddn.com/image/blog/2/4.png-blog)
{% endgp %}

分析项目的实际需要，首先要有一套基本的样式，但是有些地方的高度不同，我们的项目只需要显示一列数据进行选择，暂时不需要级联的效果。需要单选和多选的功能，而且不同地方使用时对应的 `picker-item` 显示的结构会有所不同。

总结下我们需要实现以下功能：
- 默认样式和结构
- 打开和关闭
- 自定义样式
- 单选和多选
- 自动滑动到选中行
- 自定义行结构

接下来就一一实现上面的需求。

## 需求实现

### 默认样式和结构

### 打开和关闭

### 自定义样式

### 单选和多选

### 自动滑动到选中行

### 自定义行结构

## 使用自定义组件

[0]: https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/